# .air.toml
# Air configuration for static-site dev loop.
# Build regenerates build/public; entrypoint serves build/public.

root = "."
tmp_dir = "tmp"
env_files = [".env"]

[build]
# 1) Regenerate the static site output.
cmd = "scripts/build-site"

# 2) Run the preview server (long-running). Keep this dumb; Air restarts it.
entrypoint = ["bash", "-lc", "scripts/serve"]

# Watch content/templates/static and generator code
include_ext = [
  "go",
  "html", "tpl", "tmpl",
  "css", "scss",
  "js", "ts",
  "md",
  "jpeg", "jpg", "gif", "png", "bmp", "svg", "webp", "ico"
]

exclude_dir = ["tmp", ".git", "vendor", "node_modules", "build"]
exclude_regex = ["_test\\.go"]
exclude_unchanged = true

delay = 100
stop_on_error = true

[log]
time = true
main_only = false

[screen]
clear_on_rebuild = true
keep_scroll = true

[misc]
clean_on_exit = true
