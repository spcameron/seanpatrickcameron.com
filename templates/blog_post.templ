package templates

import (
	"context"
	"io"

	"github.com/spcameron/seanpatrickcameron.com/internal/markdown/html"
	"github.com/spcameron/seanpatrickcameron.com/internal/content"
)

templ BlogPost(p content.Post) {
	@Base(p.FrontMatter.Title, BlogPostContent(p))
}

templ BlogPostContent(p content.Post) {
	<article>
		<h2>{ p.FrontMatter.Title }</h2>

		if !p.FrontMatter.Date.IsZero() {
			<p><em>{ p.FrontMatter.Date.Format("Jan 2, 2006") }</em></p>
		}

		@MarkdownHTML(p.BodyHTMLTree)
	</article>
}

func MarkdownHTML(n html.Node) templ.Component {
	return templ.ComponentFunc(func(ctx context.Context, w io.Writer) error {
		if n == nil {
			return nil
		}
		return n.Write(w)
	})
}
